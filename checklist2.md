# Checklist — Order Master® Ads Analytics

## 0. Общая готовность
- [ ] Архитектура системы определена и задокументирована
- [ ] MVP-границы зафиксированы (что входит / что осознанно отложено)
- [ ] Используется единый session_id во всех событиях
- [ ] Временная зона и формат timestamp стандартизированы

---

## 1. Сбор событий (Event Collectors)

### 1.1 session_started
- [ ] Событие отправляется с фронтенда
- [ ] Генерируется уникальный session_id
- [ ] Передается restaurant_id
- [ ] Передается restaurant_segment
- [ ] Передается timestamp
- [ ] Повторный старт сессии не дублирует UV

### 1.2 ad_impression
- [ ] Фиксируется каждый показ баннера
- [ ] Передается session_id
- [ ] Передается campaign_id
- [ ] Передается advertiser_id
- [ ] Передается banner_placement
- [ ] Передается timestamp
- [ ] Один пользователь может дать несколько impressions

### 1.3 ad_click
- [ ] Фиксируется каждый клик
- [ ] Привязан к session_id
- [ ] Привязан к campaign_id
- [ ] Привязан к advertiser_id
- [ ] Передается timestamp
- [ ] Клик невозможен без impression

### 1.4 ad_conversion
- [ ] Фиксируется целевое действие
- [ ] Привязан к session_id
- [ ] Привязан к campaign_id
- [ ] Привязан к advertiser_id
- [ ] Передается conversion_type
- [ ] Передается timestamp

---

## 2. Хранение данных

- [ ] Сырые события сохраняются без потерь
- [ ] Типы событий разделены логически или таблицами
- [ ] Возможность пересчета метрик из raw-данных
- [ ] Индексы по session_id, campaign_id, timestamp
- [ ] Хранение минимум 6–12 месяцев

---

## 3. Связывание событий и воронка

- [ ] Все события связываются по session_id
- [ ] Корректная воронка:
      session_started → ad_impression → ad_click → ad_conversion
- [ ] ad_impression невозможен без session_started
- [ ] Reach считается как unique session_id с impression
- [ ] Conversions ≤ Clicks ≤ Impressions

---

## 4. Расчет метрик (real-time / near real-time)

### Базовые
- [ ] UV (уникальные session_id)
- [ ] Reach (unique session_id с ad_impression)
- [ ] Impressions (count ad_impression)
- [ ] Clicks (count ad_click)
- [ ] Conversions (count ad_conversion)

### Производные
- [ ] CTR = Clicks / Impressions
- [ ] CR = Conversions / Reach
- [ ] CPUV = Cost / Reach
- [ ] CPC = Cost / Clicks
- [ ] CPL = Cost / Conversions

---

## 5. Биллинг (CPUV)

- [ ] Кампания имеет стоимость CPUV
- [ ] Списание происходит по факту Reach
- [ ] Нет двойного учета одного session_id
- [ ] Возможность пересчета биллинга
- [ ] Статус бюджета кампании считается корректно

---

## 6. Дашборд менеджера по рекламе

### 6.1 Сводка по кампаниям
- [ ] Таблица активных кампаний
- [ ] Advertiser
- [ ] Campaign
- [ ] UV
- [ ] Reach
- [ ] Impressions
- [ ] Clicks
- [ ] Conversions
- [ ] CTR
- [ ] CR
- [ ] CPUV
- [ ] CPL
- [ ] Статус бюджета
- [ ] Обновление ≤ 15 минут

### 6.2 Детализация кампании
- [ ] График UV во времени
- [ ] График Reach
- [ ] График Clicks
- [ ] График Conversions
- [ ] Разбивка по сегментам ресторанов
- [ ] Разбивка по ресторанам

### 6.3 Прогнозирование
- [ ] Прогноз расхода бюджета
- [ ] Учет текущего CPUV
- [ ] Учет динамики UV

---

## 7. Отчеты для рекламодателей

- [ ] Генерация PDF
- [ ] Генерация Excel
- [ ] Выбор периода
- [ ] Все ключевые метрики
- [ ] Графики показов и конверсий
- [ ] Воронка UV → Reach → Clicks → Conversions
- [ ] Сегментация по типам ресторанов

---

## 8. API и интеграции

- [ ] API для передачи событий
- [ ] API для верификации конверсий
- [ ] Авторизация API
- [ ] Документация эндпоинтов

---

## 9. Нефункциональные требования

- [ ] 100% сохранение событий
- [ ] Обработка тысяч событий в минуту
- [ ] Нет потери данных при пиках
- [ ] Изоляция данных рекламодателей
- [ ] Авторизация пользователей

---

## 10. MVP (1.5–2 недели)

- [ ] Работают все коллекторы событий
- [ ] Есть база сырых событий
- [ ] Считаются UV / Reach / Clicks / Conversions
- [ ] Есть базовый дашборд
- [ ] CPUV используется для первичного биллинга
